

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Phonon &mdash; elphmod  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/style.css?v=6b874a89" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script type="text/x-mathjax-config">MathJax.Hub.Config({"TeX": {"Macros": {"D": ["\\mathrm{d}"], "E": ["\\mathrm{e}"], "I": ["\\mathrm{i}"], "bra": ["\\langle#1|", 1], "bracket": ["\\langle#1|#2\\rangle", 2], "ket": ["|#1\\rangle", 1]}}})</script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Electron–phonon" href="elph.html" />
    <link rel="prev" title="Electron" href="el.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #e7f2fa" >

          
          
          <a href="../index.html">
            
              <img src="../_static/elphmod.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Modules</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="el.html">Electron</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Phonon</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#elphmod.ph.Model"><code class="docutils literal notranslate"><span class="pre">Model</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#elphmod.ph.Model.C"><code class="docutils literal notranslate"><span class="pre">Model.C()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#elphmod.ph.Model.D"><code class="docutils literal notranslate"><span class="pre">Model.D()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#elphmod.ph.Model.D_lr"><code class="docutils literal notranslate"><span class="pre">Model.D_lr()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#elphmod.ph.Model.clear"><code class="docutils literal notranslate"><span class="pre">Model.clear()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#elphmod.ph.Model.decay"><code class="docutils literal notranslate"><span class="pre">Model.decay()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#elphmod.ph.Model.generate_long_range"><code class="docutils literal notranslate"><span class="pre">Model.generate_long_range()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#elphmod.ph.Model.order_atoms"><code class="docutils literal notranslate"><span class="pre">Model.order_atoms()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#elphmod.ph.Model.prepare_long_range"><code class="docutils literal notranslate"><span class="pre">Model.prepare_long_range()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#elphmod.ph.Model.sample_orig"><code class="docutils literal notranslate"><span class="pre">Model.sample_orig()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#elphmod.ph.Model.shift_atoms"><code class="docutils literal notranslate"><span class="pre">Model.shift_atoms()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#elphmod.ph.Model.standardize"><code class="docutils literal notranslate"><span class="pre">Model.standardize()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#elphmod.ph.Model.sum_force_constants"><code class="docutils literal notranslate"><span class="pre">Model.sum_force_constants()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#elphmod.ph.Model.supercell"><code class="docutils literal notranslate"><span class="pre">Model.supercell()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#elphmod.ph.Model.symmetrize"><code class="docutils literal notranslate"><span class="pre">Model.symmetrize()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#elphmod.ph.Model.to_flfrc"><code class="docutils literal notranslate"><span class="pre">Model.to_flfrc()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#elphmod.ph.Model.to_pwi"><code class="docutils literal notranslate"><span class="pre">Model.to_pwi()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#elphmod.ph.Model.unit_cell"><code class="docutils literal notranslate"><span class="pre">Model.unit_cell()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#elphmod.ph.Model.update_short_range"><code class="docutils literal notranslate"><span class="pre">Model.update_short_range()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#elphmod.ph.asr"><code class="docutils literal notranslate"><span class="pre">asr()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#elphmod.ph.divide_by_mass"><code class="docutils literal notranslate"><span class="pre">divide_by_mass()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#elphmod.ph.fildyn_freq"><code class="docutils literal notranslate"><span class="pre">fildyn_freq()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#elphmod.ph.group"><code class="docutils literal notranslate"><span class="pre">group()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#elphmod.ph.interpolate_dynamical_matrices"><code class="docutils literal notranslate"><span class="pre">interpolate_dynamical_matrices()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#elphmod.ph.polarization"><code class="docutils literal notranslate"><span class="pre">polarization()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#elphmod.ph.q2r"><code class="docutils literal notranslate"><span class="pre">q2r()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#elphmod.ph.read_flfrc"><code class="docutils literal notranslate"><span class="pre">read_flfrc()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#elphmod.ph.read_flfrc_xml"><code class="docutils literal notranslate"><span class="pre">read_flfrc_xml()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#elphmod.ph.read_q"><code class="docutils literal notranslate"><span class="pre">read_q()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#elphmod.ph.read_quadrupole_fmt"><code class="docutils literal notranslate"><span class="pre">read_quadrupole_fmt()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#elphmod.ph.sgnsqrt"><code class="docutils literal notranslate"><span class="pre">sgnsqrt()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#elphmod.ph.spectral_function"><code class="docutils literal notranslate"><span class="pre">spectral_function()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#elphmod.ph.sum_rule_correction"><code class="docutils literal notranslate"><span class="pre">sum_rule_correction()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#elphmod.ph.write_flfrc"><code class="docutils literal notranslate"><span class="pre">write_flfrc()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#elphmod.ph.write_q"><code class="docutils literal notranslate"><span class="pre">write_q()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#elphmod.ph.write_quadrupole_fmt"><code class="docutils literal notranslate"><span class="pre">write_quadrupole_fmt()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#elphmod.ph.zasr"><code class="docutils literal notranslate"><span class="pre">zasr()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="elph.html">Electron–phonon</a></li>
<li class="toctree-l1"><a class="reference internal" href="elel.html">Electron–electron</a></li>
<li class="toctree-l1"><a class="reference internal" href="MPI.html">MPI</a></li>
<li class="toctree-l1"><a class="reference internal" href="bravais.html">Bravais</a></li>
<li class="toctree-l1"><a class="reference internal" href="dispersion.html">Dispersion</a></li>
<li class="toctree-l1"><a class="reference internal" href="dos.html">DOS</a></li>
<li class="toctree-l1"><a class="reference internal" href="diagrams.html">Diagrams</a></li>
<li class="toctree-l1"><a class="reference internal" href="occupations.html">Occupations</a></li>
<li class="toctree-l1"><a class="reference internal" href="md.html">MD</a></li>
<li class="toctree-l1"><a class="reference internal" href="eliashberg.html">Eliashberg</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot.html">Plot</a></li>
<li class="toctree-l1"><a class="reference internal" href="misc.html">Miscellaneous</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Models</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="models/graphene.html">Graphene</a></li>
<li class="toctree-l1"><a class="reference internal" href="models/tas2.html">TaS₂</a></li>
<li class="toctree-l1"><a class="reference internal" href="models/chain.html">Chain</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">More</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../pages/changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/patches.html">Patches</a></li>
<li class="toctree-l1"><a class="reference internal" href="../genindex.html">Index</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #e7f2fa" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">elphmod</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Phonon</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/modules/ph.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-elphmod.ph">
<span id="phonon"></span><h1>Phonon<a class="headerlink" href="#module-elphmod.ph" title="Link to this heading"></a></h1>
<p>Mass-spring models from Quantum ESPRESSO.</p>
<dl class="py class">
<dt class="sig sig-object py" id="elphmod.ph.Model">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">elphmod.ph.</span></span><span class="sig-name descname"><span class="pre">Model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flfrc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quadrupole_fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apply_asr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apply_asr_simple</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apply_zasr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apply_rsr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr2d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">at</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsil</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zeu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Q</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">perp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">divide_mass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">divide_ndegen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ifc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elphmod/ph.html#Model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elphmod.ph.Model" title="Link to this definition"></a></dt>
<dd><p>Mass-spring model for the phonons.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>flfrc</strong><span class="classifier">str</span></dt><dd><p>File with interatomic force constants from <code class="docutils literal notranslate"><span class="pre">q2r.x</span></code> or common filename
part (without appended/inserted q-point number) of dynamical matrices
from <code class="docutils literal notranslate"><span class="pre">ph.x</span></code>. Both the plain-text and XML format are supported.</p>
</dd>
<dt><strong>quadrupole_fmt</strong><span class="classifier">str</span></dt><dd><p>File with quadrupole tensors in format suitable for <code class="docutils literal notranslate"><span class="pre">epw.x</span></code>.</p>
</dd>
<dt><strong>apply_asr</strong><span class="classifier">bool</span></dt><dd><p>Apply acoustic sum rule correction to force constants?</p>
</dd>
<dt><strong>apply_asr_simple</strong><span class="classifier">bool</span></dt><dd><p>Apply simple acoustic sum rule correction to force constants? This sets
the self force constant to minus the sum of all other force constants.</p>
</dd>
<dt><strong>apply_zasr</strong><span class="classifier">bool</span></dt><dd><p>Apply acoustic sum rule correction to Born effective charges?</p>
</dd>
<dt><strong>apply_rsr</strong><span class="classifier">bool</span></dt><dd><p>Apply rotation sum rule correction to force constants?</p>
</dd>
<dt><strong>lr</strong><span class="classifier">bool</span></dt><dd><p>Compute long-range terms in case of polar material?</p>
</dd>
<dt><strong>lr2d</strong><span class="classifier">bool</span></dt><dd><p>Compute long-range terms for two-dimensional system if <cite>lr</cite>?</p>
</dd>
<dt><strong>amass</strong><span class="classifier">ndarray</span></dt><dd><p>Atomic masses if <cite>flfrc</cite> is omitted.</p>
</dd>
<dt><strong>at</strong><span class="classifier">ndarray</span></dt><dd><p>Bravais lattice vectors if <cite>flfrc</cite> is omitted.</p>
</dd>
<dt><strong>tau</strong><span class="classifier">ndarray</span></dt><dd><p>Positions of basis atoms if <cite>flfrc</cite> is omitted.</p>
</dd>
<dt><strong>atom_order</strong><span class="classifier">list of str</span></dt><dd><p>Ordered list of atoms if <cite>flfrc</cite> is omitted.</p>
</dd>
<dt><strong>alph</strong><span class="classifier">float</span></dt><dd><p>Ewald parameter if <cite>flfrc</cite> is omitted.</p>
</dd>
<dt><strong>epsil</strong><span class="classifier">ndarray</span></dt><dd><p>Dielectric tensor if <cite>flfrc</cite> is omitted.</p>
</dd>
<dt><strong>zeu</strong><span class="classifier">ndarray</span></dt><dd><p>Born effective charges if <cite>flfrc</cite> is omitted.</p>
</dd>
<dt><strong>Q</strong><span class="classifier">ndarray</span></dt><dd><p>Quadrupole tensors if <cite>quadrupole_fmt</cite> is omitted.</p>
</dd>
<dt><strong>L</strong><span class="classifier">float</span></dt><dd><p>Range-separation parameter for two-dimensional electrostatics.</p>
</dd>
<dt><strong>perp</strong><span class="classifier">bool</span></dt><dd><p>Yield out-of-plane long-range terms if <cite>L</cite> is nonzero?</p>
</dd>
<dt><strong>divide_mass</strong><span class="classifier">bool</span></dt><dd><p>Divide force constants and Born effective charges by atomic masses?</p>
</dd>
<dt><strong>divide_ndegen</strong><span class="classifier">bool</span></dt><dd><p>Divide force constants by degeneracy of Wigner-Seitz point? Only
<code class="docutils literal notranslate"><span class="pre">True</span></code> yields correct phonons. <code class="docutils literal notranslate"><span class="pre">False</span></code> should only be used for
debugging.</p>
</dd>
<dt><strong>ifc</strong><span class="classifier">str</span></dt><dd><p>Name of file with interatomic force constants to be created if <cite>flfrc</cite>
is prefix of files with dynamical matrices. Used to emulate <code class="docutils literal notranslate"><span class="pre">q2r.x</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>R</strong><span class="classifier">ndarray</span></dt><dd><p>Lattice vectors <span class="math notranslate nohighlight">\(\vec R\)</span> of Wigner-Seitz supercell.</p>
</dd>
<dt><strong>data</strong><span class="classifier">ndarray</span></dt><dd><p>Corresponding force constants divided by atomic masses in Ry<sup>2</sup>.</p>
<div class="math notranslate nohighlight">
\[D_{\vec R i j} = \frac{\hbar^2}{\sqrt{M_i M_j}}
    \frac{\partial^2 E}{\partial u_{0 i} \partial u_{\vec R j}}\]</div>
<p>If not <code class="xref py py-attr docutils literal notranslate"><span class="pre">divide_mass</span></code>, the prefactor <span class="math notranslate nohighlight">\(\hbar^2 / \sqrt{M_i
M_j}\)</span> is absent and the units are Ry/bohr<sup>2</sup> instead. If
<code class="xref py py-attr docutils literal notranslate"><span class="pre">lr</span></code>, this is only the short-range component of the force
constants.</p>
</dd>
<dt><strong>M</strong><span class="classifier">ndarray</span></dt><dd><p>Atomic masses <span class="math notranslate nohighlight">\(M_i\)</span>.</p>
</dd>
<dt><strong>a</strong><span class="classifier">ndarray</span></dt><dd><p>Bravais lattice vectors.</p>
</dd>
<dt><strong>r</strong><span class="classifier">ndarray</span></dt><dd><p>Positions of basis atoms.</p>
</dd>
<dt><strong>l</strong><span class="classifier">ndarray.</span></dt><dd><p>Bond lengths.</p>
</dd>
<dt><strong>atom_order</strong><span class="classifier">list of str</span></dt><dd><p>Ordered list of atoms.</p>
</dd>
<dt><strong>alpha</strong><span class="classifier">float</span></dt><dd><p>Ewald parameter.</p>
</dd>
<dt><strong>eps</strong><span class="classifier">ndarray</span></dt><dd><p>Dielectric tensor.</p>
</dd>
<dt><strong>Z</strong><span class="classifier">ndarray</span></dt><dd><p>Born effective charges.</p>
</dd>
<dt><strong>z</strong><span class="classifier">ndarray</span></dt><dd><p>Born effective charges divided by square root of atomic masses.</p>
</dd>
<dt><strong>Q</strong><span class="classifier">ndarray</span></dt><dd><p>Quadrupole tensors.</p>
</dd>
<dt><strong>q</strong><span class="classifier">ndarray</span></dt><dd><p>Quadrupole tensors divided by square root of atomic masses.</p>
</dd>
<dt><strong>L</strong><span class="classifier">float</span></dt><dd><p>Range-separation parameter for two-dimensional electrostatics.</p>
</dd>
<dt><strong>perp</strong><span class="classifier">bool</span></dt><dd><p>Yield out-of-plane long-range terms if <cite>L</cite> is nonzero?</p>
</dd>
<dt><strong>divide_mass</strong><span class="classifier">bool</span></dt><dd><p>Have force constants and Born charges been divided by atomic masses?</p>
</dd>
<dt><strong>divide_ndegen</strong><span class="classifier">bool</span></dt><dd><p>Have force constants been divided by degeneracy of Wigner-Seitz point?</p>
</dd>
<dt><strong>size</strong><span class="classifier">int</span></dt><dd><p>Number of displacement directions/bands.</p>
</dd>
<dt><strong>nat</strong><span class="classifier">int</span></dt><dd><p>Number of atoms.</p>
</dd>
<dt><strong>nq</strong><span class="classifier">tuple of int</span></dt><dd><p>Shape of original q-point mesh.</p>
</dd>
<dt><strong>q0</strong><span class="classifier">ndarray</span></dt><dd><p>Original q-point mesh.</p>
</dd>
<dt><strong>D0</strong><span class="classifier">ndarray</span></dt><dd><p>Dynamical matrices on original q-point mesh.</p>
</dd>
<dt><strong>cells</strong><span class="classifier">list of tuple of int, optional</span></dt><dd><p>Lattice vectors of unit cells if the model describes a supercell.</p>
</dd>
<dt><strong>N</strong><span class="classifier">list of tuple of int, optional</span></dt><dd><p>Primitive vectors of supercell if the model describes a supercell.</p>
</dd>
<dt><strong>lr</strong><span class="classifier">bool</span></dt><dd><p>Compute long-range terms?</p>
</dd>
<dt><strong>lr2d</strong><span class="classifier">bool</span></dt><dd><p>Compute long-range terms for two-dimensional system if <cite>lr</cite>?</p>
</dd>
<dt><strong>b</strong><span class="classifier">ndarray</span></dt><dd><p>Reciprocal primitive vectors if <cite>lr</cite>.</p>
</dd>
<dt><strong>prefactor</strong><span class="classifier">float</span></dt><dd><p>Prefactor of long-range terms if <cite>lr</cite>.</p>
</dd>
<dt><strong>r_eff</strong><span class="classifier">float</span></dt><dd><p>Effective thickness if <cite>lr2d</cite>.</p>
</dd>
<dt><strong>scale</strong><span class="classifier">float</span></dt><dd><p>Relevant scaling factor if <cite>lr</cite>.</p>
</dd>
<dt><strong>D0_lr</strong><span class="classifier">ndarray</span></dt><dd><p>Constant part of long-range correction to dynamical matrix if <cite>lr</cite>.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="elphmod.ph.Model.C">
<span class="sig-name descname"><span class="pre">C</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">R1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elphmod/ph.html#Model.C"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elphmod.ph.Model.C" title="Link to this definition"></a></dt>
<dd><p>Get interatomic force constants for arbitrary lattice vector.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>R1, R2, R3</strong><span class="classifier">int, default 0</span></dt><dd><p>Lattice vector in units of primitive vectors.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>ndarray</dt><dd><p>Element of <code class="xref py py-attr docutils literal notranslate"><span class="pre">data</span></code> or zero.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="elphmod.ph.Model.D">
<span class="sig-name descname"><span class="pre">D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elphmod/ph.html#Model.D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elphmod.ph.Model.D" title="Link to this definition"></a></dt>
<dd><p>Set up dynamical matrix for arbitrary q point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>q1, q2, q3</strong><span class="classifier">float, default 0.0</span></dt><dd><p>q point in crystal coordinates with period <span class="math notranslate nohighlight">\(2 \pi\)</span>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>ndarray</dt><dd><p>Fourier transform of <code class="xref py py-attr docutils literal notranslate"><span class="pre">data</span></code>, possibly plus a long-range term.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="elphmod.ph.Model.D_lr">
<span class="sig-name descname"><span class="pre">D_lr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elphmod/ph.html#Model.D_lr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elphmod.ph.Model.D_lr" title="Link to this definition"></a></dt>
<dd><p>Calculate long-range part of dynamical matrix.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="elphmod.ph.Model.clear">
<span class="sig-name descname"><span class="pre">clear</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elphmod/ph.html#Model.clear"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elphmod.ph.Model.clear" title="Link to this definition"></a></dt>
<dd><p>Delete all lattice vectors and associated matrix elements.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="elphmod.ph.Model.decay">
<span class="sig-name descname"><span class="pre">decay</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elphmod/ph.html#Model.decay"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elphmod.ph.Model.decay" title="Link to this definition"></a></dt>
<dd><p>Plot force constants as a function of bond length.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>ndarray</dt><dd><p>Bond lengths.</p>
</dd>
<dt>ndarray</dt><dd><p>Frobenius norm of force-constant matrices.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="elphmod.ph.Model.generate_long_range">
<span class="sig-name descname"><span class="pre">generate_long_range</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">perp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elphmod/ph.html#Model.generate_long_range"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elphmod.ph.Model.generate_long_range" title="Link to this definition"></a></dt>
<dd><p>Generate long-range terms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>q</strong><span class="classifier">ndarray</span></dt><dd><p>q point in reciprocal lattice units <span class="math notranslate nohighlight">\(q_i \in [0, 2 \pi)\)</span>.</p>
</dd>
<dt><strong>perp</strong><span class="classifier">bool</span></dt><dd><p>Yield out-of-plane terms? Defaults to attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">perp</span></code>.</p>
</dd>
<dt><strong>eps</strong><span class="classifier">float</span></dt><dd><p>Tolerance for vanishing lattice vectors.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>ndarray</dt><dd><p>Scalar prefactor for relevant reciprocal lattice vectors.</p>
</dd>
<dt>ndarray</dt><dd><p>Direction-dependent term for relevant reciprocal lattice vectors.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="elphmod.ph.Model.order_atoms">
<span class="sig-name descname"><span class="pre">order_atoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">order</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elphmod/ph.html#Model.order_atoms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elphmod.ph.Model.order_atoms" title="Link to this definition"></a></dt>
<dd><p>Reorder atoms.</p>
<p>Together with <a class="reference internal" href="#elphmod.ph.Model.shift_atoms" title="elphmod.ph.Model.shift_atoms"><code class="xref py py-func docutils literal notranslate"><span class="pre">shift_atoms()</span></code></a>, this function helps reconcile
inconsistent definitions of the basis/motif of the Bravais lattice.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>*order</strong><span class="classifier">int</span></dt><dd><p>New atom order.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="elphmod.ph.Model.prepare_long_range">
<span class="sig-name descname"><span class="pre">prepare_long_range</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">28.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G_2d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elphmod/ph.html#Model.prepare_long_range"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elphmod.ph.Model.prepare_long_range" title="Link to this definition"></a></dt>
<dd><p>Prepare calculation of long-range terms for polar materials.</p>
<p>The following two routines are based on <code class="docutils literal notranslate"><span class="pre">rgd_blk</span></code> and <code class="docutils literal notranslate"><span class="pre">rgd_blk_epw</span></code>
of Quantum ESPRESSO and the EPW code.</p>
<p>Copyright (C) 2010-2016 S. Ponce’, R. Margine, C. Verdi, F. Giustino
Copyright (C) 2001-2012 Quantum ESPRESSO group</p>
<p>Please refer to:</p>
<ul class="simple">
<li><p>Phonons: Gonze et al., Phys. Rev. B 50, 13035 (1994)</p></li>
<li><p>Coupling: Verdi and Giustino, Phys. Rev. Lett. 115, 176401 (2015)</p></li>
<li><p>2D case: Sohier, Calandra, and Mauri, Phys. Rev. B 94, 085415 (2016)</p></li>
<li><p>Quadrupoles: Ponce’ et al., Phys. Rev. Research 3, 043022 (2021)</p></li>
<li><p>Improved 2D phonons: Royo and Stengel, Phys. Rev. X 11, 041027 (2021)</p></li>
<li><p>Improved 2D coupling: Ponce’ et al., Phys. Rev. B 107, 155424 (2023)</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>G_max</strong><span class="classifier">float</span></dt><dd><p>Cutoff for reciprocal lattice vectors.</p>
</dd>
<dt><strong>G_2d</strong><span class="classifier">bool, default False</span></dt><dd><p>Do not sample out-of-plane reciprocal lattice vectors regardless of
<code class="xref py py-attr docutils literal notranslate"><span class="pre">lr2d</span></code>?</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="elphmod.ph.Model.sample_orig">
<span class="sig-name descname"><span class="pre">sample_orig</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elphmod/ph.html#Model.sample_orig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elphmod.ph.Model.sample_orig" title="Link to this definition"></a></dt>
<dd><p>Sample dynamical matrix on original q-point mesh.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="elphmod.ph.Model.shift_atoms">
<span class="sig-name descname"><span class="pre">shift_atoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elphmod/ph.html#Model.shift_atoms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elphmod.ph.Model.shift_atoms" title="Link to this definition"></a></dt>
<dd><p>Move selected atoms across unit-cell boundary.</p>
<p>Together with <a class="reference internal" href="#elphmod.ph.Model.order_atoms" title="elphmod.ph.Model.order_atoms"><code class="xref py py-func docutils literal notranslate"><span class="pre">order_atoms()</span></code></a>, this function helps reconcile
inconsistent definitions of the basis/motif of the Bravais lattice.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>s</strong><span class="classifier">slice</span></dt><dd><p>Slice of atom indices corresponding to selected basis atom(s).</p>
</dd>
<dt><strong>S</strong><span class="classifier">tuple of int</span></dt><dd><p>Shift of as multiple of primitive lattice vectors.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="elphmod.ph.Model.standardize">
<span class="sig-name descname"><span class="pre">standardize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetrize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elphmod/ph.html#Model.standardize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elphmod.ph.Model.standardize" title="Link to this definition"></a></dt>
<dd><p>Standardize mass-spring data.</p>
<ul class="simple">
<li><p>Keep only nonzero force-constant matrices.</p></li>
<li><p>Sum over repeated lattice vectors.</p></li>
<li><p>Sort lattice vectors.</p></li>
<li><p>Optionally symmetrize force constants:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[D_{\vec q} = D_{\vec q}^\dagger,
D_{\vec R} = D_{-\vec R}^\dagger\]</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="elphmod.ph.Model.sum_force_constants">
<span class="sig-name descname"><span class="pre">sum_force_constants</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elphmod/ph.html#Model.sum_force_constants"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elphmod.ph.Model.sum_force_constants" title="Link to this definition"></a></dt>
<dd><p>Calculate sum of absolute values of short-range force constants.</p>
<p>For the optimal range-separation parameter this value is minimal.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="elphmod.ph.Model.supercell">
<span class="sig-name descname"><span class="pre">supercell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sparse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elphmod/ph.html#Model.supercell"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elphmod.ph.Model.supercell" title="Link to this definition"></a></dt>
<dd><p>Map mass-spring model onto supercell.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>N1, N2, N3</strong><span class="classifier">tuple of int or int, default 1</span></dt><dd><p>Supercell lattice vectors in units of primitive lattice vectors.</p>
</dd>
<dt><strong>sparse</strong><span class="classifier">bool, default False</span></dt><dd><p>Only calculate q = 0 dynamical matrix as a sparse matrix to save
memory? The result is stored in the attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">Ds</span></code>. Consider
using <a class="reference internal" href="#elphmod.ph.Model.standardize" title="elphmod.ph.Model.standardize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">standardize()</span></code></a> with nonzero <cite>eps</cite> and <cite>symmetrize</cite>
before.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>object</dt><dd><p>Mass-spring model for supercell.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="bravais.html#elphmod.bravais.supercell" title="elphmod.bravais.supercell"><code class="xref py py-obj docutils literal notranslate"><span class="pre">elphmod.bravais.supercell</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="elphmod.ph.Model.symmetrize">
<span class="sig-name descname"><span class="pre">symmetrize</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elphmod/ph.html#Model.symmetrize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elphmod.ph.Model.symmetrize" title="Link to this definition"></a></dt>
<dd><p>Symmetrize dynamical matrix.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="elphmod.ph.Model.to_flfrc">
<span class="sig-name descname"><span class="pre">to_flfrc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flfrc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nr1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nr2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nr3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elphmod/ph.html#Model.to_flfrc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elphmod.ph.Model.to_flfrc" title="Link to this definition"></a></dt>
<dd><p>Save mass-spring model to force-constants file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>flfrc</strong><span class="classifier">str</span></dt><dd><p>Filename.</p>
</dd>
<dt><strong>nr1, nr2, nr3</strong><span class="classifier">int, optional</span></dt><dd><p>Mesh dimensions. If not given, <code class="xref py py-attr docutils literal notranslate"><span class="pre">nq</span></code> is assumed.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="elphmod.ph.Model.to_pwi">
<span class="sig-name descname"><span class="pre">to_pwi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pwi</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elphmod/ph.html#Model.to_pwi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elphmod.ph.Model.to_pwi" title="Link to this definition"></a></dt>
<dd><p>Save atomic positions etc. to PWscf input file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>pwi</strong><span class="classifier">str</span></dt><dd><p>Filename.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Keyword arguments with further parameters to be written.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="elphmod.ph.Model.unit_cell">
<span class="sig-name descname"><span class="pre">unit_cell</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elphmod/ph.html#Model.unit_cell"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elphmod.ph.Model.unit_cell" title="Link to this definition"></a></dt>
<dd><p>Map mass-spring model back to unit cell.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#elphmod.ph.Model.supercell" title="elphmod.ph.Model.supercell"><code class="xref py py-obj docutils literal notranslate"><span class="pre">supercell</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="elphmod.ph.Model.update_short_range">
<span class="sig-name descname"><span class="pre">update_short_range</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flfrc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apply_asr_simple</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elphmod/ph.html#Model.update_short_range"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elphmod.ph.Model.update_short_range" title="Link to this definition"></a></dt>
<dd><p>Update short-range part of interatomic force constants.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>flfrc</strong><span class="classifier">str</span></dt><dd><p>Filename where short-range force constants are written.</p>
</dd>
<dt><strong>apply_asr_simple</strong><span class="classifier">bool</span></dt><dd><p>Apply simple acoustic sum rule correction to short-range force
constants?</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="elphmod.ph.asr">
<span class="sig-prename descclassname"><span class="pre">elphmod.ph.</span></span><span class="sig-name descname"><span class="pre">asr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phid</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elphmod/ph.html#asr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elphmod.ph.asr" title="Link to this definition"></a></dt>
<dd><p>Apply simple acoustic sum rule correction to force constants.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="elphmod.ph.divide_by_mass">
<span class="sig-prename descclassname"><span class="pre">elphmod.ph.</span></span><span class="sig-name descname"><span class="pre">divide_by_mass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dyn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amass</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elphmod/ph.html#divide_by_mass"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elphmod.ph.divide_by_mass" title="Link to this definition"></a></dt>
<dd><p>Divide dynamical matrices by atomic masses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>dyn</strong><span class="classifier">ndarray</span></dt><dd><p>Dynamical matrices.</p>
</dd>
<dt><strong>amass</strong><span class="classifier">list of float</span></dt><dd><p>Atomic masses.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="elphmod.ph.fildyn_freq">
<span class="sig-prename descclassname"><span class="pre">elphmod.ph.</span></span><span class="sig-name descname"><span class="pre">fildyn_freq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fildyn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'matdyn'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elphmod/ph.html#fildyn_freq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elphmod.ph.fildyn_freq" title="Link to this definition"></a></dt>
<dd><p>Create <em>fildyn.freq</em> as created by Quantum ESPRESSO’s <code class="docutils literal notranslate"><span class="pre">ph.x</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>fildyn</strong><span class="classifier">str, default ‘matdyn’</span></dt><dd><p>Prefix of files with dynamical matrices.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="elphmod.ph.group">
<span class="sig-prename descclassname"><span class="pre">elphmod.ph.</span></span><span class="sig-name descname"><span class="pre">group</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elphmod/ph.html#group"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elphmod.ph.group" title="Link to this definition"></a></dt>
<dd><p>Create slice of dynamical matrix belonging to <cite>n</cite>-th atom.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="elphmod.ph.interpolate_dynamical_matrices">
<span class="sig-prename descclassname"><span class="pre">elphmod.ph.</span></span><span class="sig-name descname"><span class="pre">interpolate_dynamical_matrices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fildyn_template</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fildyn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flfrc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_fildyn0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apply_asr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apply_asr_simple</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apply_rsr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">divide_mass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qe_prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elphmod/ph.html#interpolate_dynamical_matrices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elphmod.ph.interpolate_dynamical_matrices" title="Link to this definition"></a></dt>
<dd><p>Interpolate dynamical matrices given for irreducible wedge of q points.</p>
<p>This function still uses the Quantum ESPRESSO executables <code class="docutils literal notranslate"><span class="pre">q2qstar.x</span></code> and
<code class="docutils literal notranslate"><span class="pre">q2r.x</span></code>.  They are called in serial by each MPI process, which leads to
problems if they have been compiled for parallel execution. If you want to
run this function in parallel, you have two choices:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Configure Quantum ESPRESSO for compilation of serial executables
via <code class="docutils literal notranslate"><span class="pre">./configure</span> <span class="pre">--disable-parallel</span></code> and run <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">ph</span></code>. If you
do not want to make them available through the environmental
variable <code class="docutils literal notranslate"><span class="pre">PATH</span></code>, you can also set the parameter <cite>qe-prefix</cite> to
<code class="docutils literal notranslate"><span class="pre">'/path/to/serial/q-e/bin/'</span></code>.  The trailing slash is required.</p></li>
<li><p>If your MPI implementation supports nested calls to <code class="docutils literal notranslate"><span class="pre">mpirun</span></code>, you
may try to set <cite>qe_prefix</cite> to <code class="docutils literal notranslate"><span class="pre">'mpirun</span> <span class="pre">-np</span> <span class="pre">1</span> <span class="pre">'</span></code>. The trailing
space is required.</p></li>
</ol>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>D</strong><span class="classifier">list of square arrays</span></dt><dd><p>Dynamical matrices for all irreducible q points.</p>
</dd>
<dt><strong>q</strong><span class="classifier">list of 2-tuples</span></dt><dd><p>Irreducible q points in crystal coordinates with period <span class="math notranslate nohighlight">\(2 \pi\)</span>.</p>
</dd>
<dt><strong>nq</strong><span class="classifier">int</span></dt><dd><p>Number of q points per dimension, i.e., size of uniform mesh.</p>
</dd>
<dt><strong>fildyn_template</strong><span class="classifier">str</span></dt><dd><p>Complete name of <em>fildyn</em> file from which to take header information.</p>
</dd>
<dt><strong>fildyn</strong><span class="classifier">str</span></dt><dd><p>Prefix for written files with dynamical matrices.</p>
</dd>
<dt><strong>flfrc</strong><span class="classifier">str</span></dt><dd><p>Name of written file with interatomic force constants.</p>
</dd>
<dt><strong>write_fildyn0</strong><span class="classifier">bool</span></dt><dd><p>Write <em>fildyn0</em> needed by <code class="docutils literal notranslate"><span class="pre">q2r.x</span></code>? Otherwise the file must be present.</p>
</dd>
<dt><strong>apply_asr</strong><span class="classifier">bool</span></dt><dd><p>Enforce acoustic sum rule by overwriting self force constants?</p>
</dd>
<dt><strong>apply_asr_simple</strong><span class="classifier">bool</span></dt><dd><p>Apply simple acoustic sum rule correction to force constants? This sets
the self force constant to minus the sum of all other force constants.</p>
</dd>
<dt><strong>apply_rsr</strong><span class="classifier">bool</span></dt><dd><p>Enforce rotation sum rule by overwriting self force constants?</p>
</dd>
<dt><strong>divide_mass</strong><span class="classifier">bool</span></dt><dd><p>Have input dynamical matrices been divided by atomic mass? This is
independent of <code class="docutils literal notranslate"><span class="pre">ph.divide_mass</span></code>, which is always respected.</p>
</dd>
<dt><strong>qe_prefix</strong><span class="classifier">str</span></dt><dd><p>String to prepend to names of Quantum ESPRESSO executables.</p>
</dd>
<dt><strong>clean</strong><span class="classifier">bool</span></dt><dd><p>Delete all temporary files afterwards?</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>function</dt><dd><p>Fourier-interpolant (via force constants) for dynamical matrices.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="elphmod.ph.polarization">
<span class="sig-prename descclassname"><span class="pre">elphmod.ph.</span></span><span class="sig-name descname"><span class="pre">polarization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">60</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elphmod/ph.html#polarization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elphmod.ph.polarization" title="Link to this definition"></a></dt>
<dd><p>Characterize as in-plane longitudinal/transverse or out-of-plane.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="elphmod.ph.q2r">
<span class="sig-prename descclassname"><span class="pre">elphmod.ph.</span></span><span class="sig-name descname"><span class="pre">q2r</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D_irr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_irr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D_full</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">60</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apply_asr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apply_asr_simple</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apply_rsr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flfrc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">divide_mass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elphmod/ph.html#q2r"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elphmod.ph.q2r" title="Link to this definition"></a></dt>
<dd><p>Interpolate dynamical matrices given for irreducible wedge of q points.</p>
<p>This function replaces <cite>interpolate_dynamical_matrices</cite>, which depends on
Quantum ESPRESSO. For 2D lattices, it is sufficient to provide dynamical
matrices <cite>D_irr</cite> for the irreducible q points <cite>q_irr</cite>. Here, for the square
lattice, the rotation symmetry (90 degrees) is currently disabled! In turn,
for 1D and 2D lattices, dynamical matrices <cite>D_full</cite> on the complete uniform
q-point mesh must be given.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>ph</strong><span class="classifier"><a class="reference internal" href="#elphmod.ph.Model" title="elphmod.ph.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a></span></dt><dd><p>Mass-spring model.</p>
</dd>
<dt><strong>D_irr</strong><span class="classifier">list of square arrays</span></dt><dd><p>Dynamical matrices for all irreducible q points.</p>
</dd>
<dt><strong>q_irr</strong><span class="classifier">list of 2-tuples</span></dt><dd><p>Irreducible q points in crystal coordinates with period <span class="math notranslate nohighlight">\(2 \pi\)</span>.</p>
</dd>
<dt><strong>nq</strong><span class="classifier">int or tuple of int</span></dt><dd><p>Number of q points per dimension, i.e., size of uniform mesh. Different
numbers of q points along different axes can be specified via a tuple.
Alternatively, <cite>nq</cite> is inferred from the shape of <cite>D_full</cite>.</p>
</dd>
<dt><strong>D_full</strong><span class="classifier">ndarray</span></dt><dd><p>Dynamical matrices on complete uniform q-point mesh.</p>
</dd>
<dt><strong>angle</strong><span class="classifier">float</span></dt><dd><p>Angle between mesh axes in degrees.</p>
</dd>
<dt><strong>apply_asr</strong><span class="classifier">bool</span></dt><dd><p>Enforce acoustic sum rule by overwriting self force constants?</p>
</dd>
<dt><strong>apply_asr_simple</strong><span class="classifier">bool</span></dt><dd><p>Apply simple acoustic sum rule correction to force constants? This sets
the self force constant to minus the sum of all other force constants.</p>
</dd>
<dt><strong>apply_rsr</strong><span class="classifier">bool</span></dt><dd><p>Enforce rotation sum rule by overwriting self force constants?</p>
</dd>
<dt><strong>flfrc</strong><span class="classifier">str</span></dt><dd><p>Filename. If given, save file with force constants as generated by
<code class="docutils literal notranslate"><span class="pre">q2r.x</span></code>. This is done before acoustic and rotation sum are applied.</p>
</dd>
<dt><strong>divide_mass</strong><span class="classifier">bool</span></dt><dd><p>Have input dynamical matrices been divided by atomic mass? This is
independent of <code class="docutils literal notranslate"><span class="pre">ph.divide_mass</span></code>, which is always respected.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="elphmod.ph.read_flfrc">
<span class="sig-prename descclassname"><span class="pre">elphmod.ph.</span></span><span class="sig-name descname"><span class="pre">read_flfrc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flfrc</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elphmod/ph.html#read_flfrc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elphmod.ph.read_flfrc" title="Link to this definition"></a></dt>
<dd><p>Read force constants in real or reciprocal space.</p>
<p><cite>flfrc</cite> can be either the force-constants file generated by <code class="docutils literal notranslate"><span class="pre">q2r.x</span></code> or one
of the dynamical-matrix files generated by <code class="docutils literal notranslate"><span class="pre">ph.x</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>ndarray or tuple of list of ndarray</dt><dd><p>Force constants for input generated by <code class="docutils literal notranslate"><span class="pre">q2r.x</span></code> or equivalent q points
and corresponding dynamical matrices for input generated by <code class="docutils literal notranslate"><span class="pre">ph.x</span></code>.</p>
</dd>
<dt>ndarray</dt><dd><p>Atomic masses.</p>
</dd>
<dt>ndarray</dt><dd><p>Bravais lattice vectors.</p>
</dd>
<dt>ndarray</dt><dd><p>Atomic positions/basis vectors.</p>
</dd>
<dt>list of str</dt><dd><p>Atomic symbols.</p>
</dd>
<dt>float</dt><dd><p>Ewald parameter.</p>
</dd>
<dt>ndarray</dt><dd><p>Dielectric tensor.</p>
</dd>
<dt>ndarray</dt><dd><p>Born effective charges.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#elphmod.ph.write_flfrc" title="elphmod.ph.write_flfrc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">write_flfrc</span></code></a></dt><dd><p>Inverse function.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="elphmod.ph.read_flfrc_xml">
<span class="sig-prename descclassname"><span class="pre">elphmod.ph.</span></span><span class="sig-name descname"><span class="pre">read_flfrc_xml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flfrc</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elphmod/ph.html#read_flfrc_xml"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elphmod.ph.read_flfrc_xml" title="Link to this definition"></a></dt>
<dd><p>Read force constants in real or reciprocal space from XML files.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#elphmod.ph.read_flfrc" title="elphmod.ph.read_flfrc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_flfrc</span></code></a></dt><dd><p>Equivalent function for non-XML files.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="elphmod.ph.read_q">
<span class="sig-prename descclassname"><span class="pre">elphmod.ph.</span></span><span class="sig-name descname"><span class="pre">read_q</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fildyn0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elphmod/ph.html#read_q"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elphmod.ph.read_q" title="Link to this definition"></a></dt>
<dd><p>Read list of irreducible q points from <em>fildyn0</em>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="elphmod.ph.read_quadrupole_fmt">
<span class="sig-prename descclassname"><span class="pre">elphmod.ph.</span></span><span class="sig-name descname"><span class="pre">read_quadrupole_fmt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">quadrupole_fmt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elphmod/ph.html#read_quadrupole_fmt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elphmod.ph.read_quadrupole_fmt" title="Link to this definition"></a></dt>
<dd><p>Read file <em>quadrupole.fmt</em> suitable for <code class="docutils literal notranslate"><span class="pre">epw.x</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>quadrupole_fmt</strong><span class="classifier">str</span></dt><dd><p>Filename.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>Q</strong><span class="classifier">ndarray</span></dt><dd><p>Quadrupole tensor.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#elphmod.ph.write_quadrupole_fmt" title="elphmod.ph.write_quadrupole_fmt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">write_quadrupole_fmt</span></code></a></dt><dd><p>Inverse function.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="elphmod.ph.sgnsqrt">
<span class="sig-prename descclassname"><span class="pre">elphmod.ph.</span></span><span class="sig-name descname"><span class="pre">sgnsqrt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elphmod/ph.html#sgnsqrt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elphmod.ph.sgnsqrt" title="Link to this definition"></a></dt>
<dd><p>Calculate signed square root.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="elphmod.ph.spectral_function">
<span class="sig-prename descclassname"><span class="pre">elphmod.ph.</span></span><span class="sig-name descname"><span class="pre">spectral_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elphmod/ph.html#spectral_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elphmod.ph.spectral_function" title="Link to this definition"></a></dt>
<dd><p>Calculate phonon spectral function.</p>
<p>See Eq. 76 by Monacelli et al., J. Phys. Condens. Matter 33, 363001 (2021).
We use an additional prefactor of 2 to normalize the frequency integral
(from zero to infinity) of the phonon spectral function to the number of
modes (for each q point).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>D</strong><span class="classifier">ndarray</span></dt><dd><p>Dynamical matrix. The last three axes belong to the two displacement
directions and the frequency argument.</p>
</dd>
<dt><strong>omega</strong><span class="classifier">ndarray</span></dt><dd><p>Frequency arguments.</p>
</dd>
<dt><strong>eta</strong><span class="classifier">float</span></dt><dd><p>Broadening parameter for all phonon modes.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>ndarray</dt><dd><p>Spectral function. The first axes belongs to the frequency argument.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="elphmod.ph.sum_rule_correction">
<span class="sig-prename descclassname"><span class="pre">elphmod.ph.</span></span><span class="sig-name descname"><span class="pre">sum_rule_correction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rsr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">report</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elphmod/ph.html#sum_rule_correction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elphmod.ph.sum_rule_correction" title="Link to this definition"></a></dt>
<dd><p>Apply sum rule correction to force constants.</p>
<p>Unlike <a class="reference internal" href="#elphmod.ph.asr" title="elphmod.ph.asr"><code class="xref py py-func docutils literal notranslate"><span class="pre">asr()</span></code></a> called by the argument <cite>apply_asr_simple</cite>, the corrected
force constants may not fulfill the point-symmetries of the crystal anymore.
In turn, the total deviation from the original force constants is minimized.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>ph</strong><span class="classifier"><a class="reference internal" href="#elphmod.ph.Model" title="elphmod.ph.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a></span></dt><dd><p>Mass-spring model for the phonons.</p>
</dd>
<dt><strong>asr</strong><span class="classifier">bool</span></dt><dd><p>Enforce acoustic sum rule?</p>
</dd>
<dt><strong>rsr</strong><span class="classifier">bool</span></dt><dd><p>Enforce Born-Huang rotation sum rule?</p>
</dd>
<dt><strong>eps</strong><span class="classifier">float</span></dt><dd><p>Smallest safe absolute value of divisor.</p>
</dd>
<dt><strong>report</strong><span class="classifier">bool</span></dt><dd><p>Print sums before and after correction?</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="elphmod.ph.write_flfrc">
<span class="sig-prename descclassname"><span class="pre">elphmod.ph.</span></span><span class="sig-name descname"><span class="pre">write_flfrc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flfrc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">at</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsil</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zeu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elphmod/ph.html#write_flfrc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elphmod.ph.write_flfrc" title="Link to this definition"></a></dt>
<dd><p>Write force constants in real or reciprocal space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>flfrc</strong><span class="classifier">str</span></dt><dd><p>Filename.</p>
</dd>
<dt><strong>phid</strong><span class="classifier">ndarray or tuple of list of ndarray</span></dt><dd><p>Force constants or equivalent q points and corresponding dynamical
matrices.</p>
</dd>
<dt><strong>amass</strong><span class="classifier">ndarray</span></dt><dd><p>Atomic masses.</p>
</dd>
<dt><strong>at</strong><span class="classifier">ndarray</span></dt><dd><p>Bravais lattice vectors.</p>
</dd>
<dt><strong>tau</strong><span class="classifier">ndarray</span></dt><dd><p>Atomic positions/basis vectors.</p>
</dd>
<dt><strong>atom_order</strong><span class="classifier">list of str</span></dt><dd><p>Atomic symbols.</p>
</dd>
<dt><strong>alph</strong><span class="classifier">float</span></dt><dd><p>Ewald parameter.</p>
</dd>
<dt><strong>epsil</strong><span class="classifier">ndarray</span></dt><dd><p>Dielectric tensor.</p>
</dd>
<dt><strong>zeu</strong><span class="classifier">ndarray</span></dt><dd><p>Born effective charges.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#elphmod.ph.read_flfrc" title="elphmod.ph.read_flfrc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_flfrc</span></code></a></dt><dd><p>Inverse function.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="elphmod.ph.write_q">
<span class="sig-prename descclassname"><span class="pre">elphmod.ph.</span></span><span class="sig-name descname"><span class="pre">write_q</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fildyn0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elphmod/ph.html#write_q"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elphmod.ph.write_q" title="Link to this definition"></a></dt>
<dd><p>Write list of irreducible q points to <em>fildyn0</em>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="elphmod.ph.write_quadrupole_fmt">
<span class="sig-prename descclassname"><span class="pre">elphmod.ph.</span></span><span class="sig-name descname"><span class="pre">write_quadrupole_fmt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">quadrupole_fmt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Q</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elphmod/ph.html#write_quadrupole_fmt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elphmod.ph.write_quadrupole_fmt" title="Link to this definition"></a></dt>
<dd><p>Write file <em>quadrupole.fmt</em> suitable for <code class="docutils literal notranslate"><span class="pre">epw.x</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>quadrupole_fmt</strong><span class="classifier">str</span></dt><dd><p>Filename.</p>
</dd>
<dt><strong>Q</strong><span class="classifier">ndarray</span></dt><dd><p>Quadrupole tensor.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#elphmod.ph.read_quadrupole_fmt" title="elphmod.ph.read_quadrupole_fmt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_quadrupole_fmt</span></code></a></dt><dd><p>Inverse function.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="elphmod.ph.zasr">
<span class="sig-prename descclassname"><span class="pre">elphmod.ph.</span></span><span class="sig-name descname"><span class="pre">zasr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elphmod/ph.html#zasr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elphmod.ph.zasr" title="Link to this definition"></a></dt>
<dd><p>Apply acoustic sum rule correction to Born effective charges.</p>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="el.html" class="btn btn-neutral float-left" title="Electron" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="elph.html" class="btn btn-neutral float-right" title="Electron–phonon" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017-2025 elphmod Developers.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>